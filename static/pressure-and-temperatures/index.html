<!DOCTYPE html>
<html lang="en">
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
  <link rel="stylesheet" href="style.css" type="text/css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>
  <script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
  <script>
  $(document).ready(function (){
      console.log("JQuery ready");

      $("#button").click(()=>{
        var apikey = $("#apikey").val();
        var request= $.ajax({
              type: "GET",
              url: "/api/v1/pressure-and-temperatures?apikey="+apikey,
              success: function(data) {
                $('#resultados').html(data);
                $('#resultados div').slideDown(1000);
              }
        });

        request.done((data)=>{
          var location = "";
          $.each(data, function (i, item) {
            location += "<tr class='text-center'><div class='checkbox'><td id='td2'><input id='checkbox" + i + "' type='checkbox'></td></div>"+"<td id='td1'>"+ data[i].name + "</td><td id='td2'>" + data[i].month +"</td><td id='td1'>"+ data[i].year + "</td><td id='td2'>" + data[i].p + "</td><td id='td1'>"+ data[i].t +  "</td><td id='td2'>"+ data[i].td + '</td></tr>';

          });
          $('#location').html(location);
          console.log(location);
        });

        request.always((jqXHR,status)=>{
          if(jqXHR.status == 401){
            $("#log1").html("No se puede utilizar una apikey inválida");
          }else{
              $("#log1").html("");
          }
        });
      });

      $("#button2").click(()=>{
        console.log("Handling click");
        var apikey = $("#apikey").val();
        var prueba='{"name": "Sevilla","month": "Enero","year": 2015,"p": 879,"t": 9.8,"td": 3.1}';
        var meta = JSON.parse(prueba);

        var nombre2 = $("#nombre2").val();
        var mes = $("#mes").val();
        var year = $("#year").val();
        var pression = $("#pression").val();
        var temperature= $("#temperature").val();
        var td = $("#td").val();


        meta["name"] = nombre2;
        meta["month"] = mes;
        meta["year"] = year;
        meta["p"] = pression;
        meta["t"] = temperature;
        meta["td"] = td;

        var json = JSON.stringify(meta);

        var request= $.ajax({
          url:"/api/v1/pressure-and-temperatures?apikey="+apikey,
          type:"POST",
          data: json,
          contentType : "application/json"
        });

        request.done(function(data,status,jqXHR) {

          $("#data").text(JSON.stringify(data));

        });

        request.always(function(jqXHR, status) {
          if(jqXHR.status == 401){
            $("#log1").html("No se puede utilizar una apikey inválida");
          }else{
              $("#log1").html("");
          }
          if(jqXHR.status == 409){
            $("#log1").html("No se puede añadir un recurso que ya existe");
          }else{
              $("#log1").html("");
          }
        });
      });

      $("#button3").click(()=>{
        console.log("Handling click");
        var prueba='{"name": "Sevilla","month": "Enero","year": 2015,"p": 879,"t": 9.8,"td": 3.1}';
        var meta = JSON.parse(prueba);
        var apikey = $("#apikey").val();
        var nombre2 = $("#nombre2").val();
        var mes = $("#mes").val();
        var year = $("#year").val();
        var pression = $("#pression").val();
        var temperature= $("#temperature").val();
        var td = $("#td").val();


        meta["name"] = nombre2;
        meta["month"] = mes;
        meta["year"] = year;
        meta["p"] = pression;
        meta["t"] = temperature;
        meta["td"] = td;

        var json = JSON.stringify(meta);

        console.log(json);
        console.log(json.name);
        console.log(json.month);

        var request= $.ajax({
          url: '/api/v1/pressure-and-temperatures/'+nombre2+"?apikey="+apikey,
          type:"PUT",
          data:  json ,
          contentType : "application/json",
          success: function(data) {
            $('#resultados').html(data);
            $('#resultados div').slideDown(1000);
          }
        });

        request.done(function(data,status,jqXHR) {
          $("#data").text(JSON.stringify(data));

        });

        request.always(function(jqXHR, status) {
          if(jqXHR.status == 401){
            $("#log1").html("No se puede utilizar una apikey inválida");
          }else{
              $("#log1").html("");
          }
        });
      });


      $("#button5").click(()=>{
        console.log("Handling click");
        var apikey = $("#apikey").val();
        var request= $.ajax({
          url:"/api/v1/pressure-and-temperatures/loadInitialData?apikey="+apikey,
          type:"GET",
          contentType : "application/json"
        });

        request.done((data)=>{
          var location = "";
          $.each(data, function (i, item) {
            location += "<tr class='text-center'><div class='checkbox'><td id='td2'><input id='checkbox" + i + "' type='checkbox'></td></div>"+"<td id='td1'>"+ data[i].name + "</td><td id='td2'>" + data[i].month +"</td><td id='td1'>"+ data[i].year + "</td><td id='td2'>" + data[i].p + "</td><td id='td1'>"+ data[i].t +  "</td><td id='td2'>"+ data[i].td + '</td></tr>';
          });
          $('#location').html(location);
          console.log(location);
        });

        request.always((jqXHR,status)=>{
          if(jqXHR.status == 401){
<<<<<<< HEAD
            $("#log1").html("No se puede utilizar una apikey inválida");
=======
            $("#log1").html("invalid apikey");
          }else{
              $("#log1").html("");
          }
        });
      });
      $("#button6").click(()=>{
        var limit = $("#limit").val();
        var offset = $("#offset").val();
        var nombre3 = $("#nombre3").val();
        var apikey = $("#apikey").val();
        console.log(limit);
        var request= $.ajax({
              type: "GET",
              url: '/api/v1/pressure-and-temperatures/'+nombre3+'?limit='+limit+'&offset='+offset+"&apikey="+apikey,
              success: function(data) {
                $('#resultados').html(data);
                $('#resultados div').slideDown(1000);
              }
        });

        request.done((data)=>{
          var location = "";
          $.each(data, function (i, item) {
            location += "<tr class='text-center'><div class='checkbox'><td id='td2'><input id='checkbox" + i + "' type='checkbox'></td></div>"+"<td id='td1'>"+ data[i].name + "</td><td id='td2'>" + data[i].month +"</td><td id='td1'>"+ data[i].year + "</td><td id='td2'>" + data[i].p + "</td><td id='td1'>"+ data[i].t +  "</td><td id='td2'>"+ data[i].td + '</td></tr>';

          });
          $('#location').html(location);
          console.log(location);
        });

        request.always((jqXHR,status)=>{
          if(jqXHR.status == 401){
            $("#log1").html("invalid apikey");
>>>>>>> 101485c0fbdbc16323d094732215c2d71f1540da
          }else{
              $("#log1").html("");
          }
        });
      });

      $("#button7").click(()=>{
        var limit = $("#limit").val();
        var offset = $("#offset").val();
        var search1 = $("#search1").val();
        var search2 = $("#search2").val();
        var method = $("input[type=radio]:checked").attr("id");
        var method1 = $("input[type=checkbox]:checked").attr("id");
        var apikey = $("#apikey").val();

        var request= $.ajax({
              type: "GET",
              url: '/api/v1/pressure-and-temperatures?'+method+search1+"&limit="+limit+"&offset="+offset+/*"&"+method1+search2+*/"&apikey="+apikey,
              success: function(data) {
                $('#resultados').html(data);
                $('#resultados div').slideDown(1000);
              }
        });
        request.done((data)=>{
          var location = "";
          $.each(data, function (i, item) {
            location +="<tr><td id='td2'>" + i +"</td><td id='td1'>" + data[i].name + "</td><td id='td2'>" + data[i].month +"</td><td id='td1'>"+ data[i].year + "</td><td id='td2'>" + data[i].p + "</td><td id='td1'>"+ data[i].t +  "</td><td id='td2'>"+ data[i].td + '</td></tr>';

          });
          $('#location').html(location);
          console.log(location);
        });

        request.always((jqXHR,status)=>{
          if(jqXHR.status == 401){
            $("#log1").html("No se puede utilizar una apikey inválida");
          }else{
              $("#log1").html("");
          }
        });
      });

      $("#button10").click(()=>{
        var apikey = $("#apikey").val();
        var contador=0;
        var request= $.ajax({
          url:"/api/v1/pressure-and-temperatures?apikey="+apikey,
          type:"GET",
          contentType : "application/json"
        });

        request.done((data)=>{
          var selection = [];
          $.each(data, function (i, item) {
            if($("#checkbox" + i).is(':checked')){
              selection.push(item);
              contador++;
              var name5=item.name;
              var request1= $.ajax({
                    type: "DELETE",
                    contentType : "application/json",
                    url: '/api/v1/pressure-and-temperatures/'+name5+"?apikey="+apikey,
                    success: function(data) {
                      $('#resultados').html(data);
                      $('#resultados div').slideDown(1000);
                    }
              });
            }
          });
          if(contador==0){
            var request2= $.ajax({
                  type: "DELETE",
                  contentType : "application/json",
                  url: "/api/v1/pressure-and-temperatures?apikey="+apikey,
                  success: function(data) {
                    $('#resultados').html(data);
                    $('#resultados div').slideDown(1000);
                  }
            });

          }
        });
        request.always((jqXHR,status)=>{
          if(jqXHR.status == 401){
            $("#log1").html("No se puede utilizar una apikey inválida");
          }else{
              $("#log1").html("");
          }
        });
      });
      $("#button11").click(()=>{
        var nombre3 = $("#nombre3").val();
        var apikey = $("#apikey").val();
        var frm = $("#from").val();
        var to1 = $("#to").val();

        var request= $.ajax({
              type: "GET",
              url: '/api/v1/pressure-and-temperatures/'+nombre3+"?from="+frm+"&to="+to1+"&apikey="+apikey,
              success: function(data) {
                $('#resultados').html(data);
                $('#resultados div').slideDown(1000);
              }
        });
        request.done((data)=>{
          var location = "";
          $.each(data, function (i, item) {
            location +="<tr><td id='td2'>" + i +"</td><td id='td1'>" + data[i].name + "</td><td id='td2'>" + data[i].month +"</td><td id='td1'>"+ data[i].year + "</td><td id='td2'>" + data[i].p + "</td><td id='td1'>"+ data[i].t +  "</td><td id='td2'>"+ data[i].td + '</td></tr>';

          });
          $('#location').html(location);
          console.log(location);
        });

        request.always((jqXHR,status)=>{
          if(jqXHR.status == 401){
            $("#log1").html("No se puede utilizar una apikey inválida");
          }else{
              $("#log1").html("");
          }
        });
      });
    });
  </script>
</head>
<body>
  <div class="container">
    <div class="panel panel-primary">
      <div class="panel-heading">Data management</div>
      <table class="table table-bordered">
        <table id="location1" class="table table-bordered">
          <tr><td>Check</td><td>Name</td><td>Month</td><td>Year</td><td>Pres</td><td>Temp</td><td>T.D.</td></tr>
        </table>
        <table id="location" class="table table-bordered table-hover">
        </table>
    </div>
      <div class="dropdown">
        <form class="form-inline">
          <button class="btn btn-primary active" type="button" id="menu2" data-toggle="dropdown">Search<span class="caret"></span></button>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <ul class="dropdown-menu" role="menu" aria-labelledby="menu2">
              <li role="presentation"><b>Choose an option and</b>
              <li role="presentation"><b>write your search:</b>
              <li role="presentation"><input id="name=" type="radio" name="x"  value="name3"><b> Name </b><br>
              <li role="presentation"><input id="month="type="radio" name="x"  value="month2"><b> Month </b><br>
              <li role="presentation"><input id="year=" type="radio" name="x" value="year"> <b>Year </b><br>
              <li role="presentation"><input id="p=" type="radio" name="x"   value="pression"><b> Pression</b><br>
              <li role="presentation"><input id="t=" type="radio" name="x"  value="temperature"> <b>Temperature </b><br>
              <li role="presentation"><input id="td=" type="radio" name="x"  value="tdyear"> <b>T.D </b></br>
              <li role="presentation"><input id="search1" class="form-control" size="15" type="text" placeholder="search" ></br>
              <input id="limit" class="form-control" type="number"size="15" placeholder="limit"></br>
              <input id="offset" class="form-control" type="number"size="15" placeholder="offset"></br>
              <li role="presentation"><button id="button7" type="button" class="btn btn-primary active" onclick="this.value=''";>Search</button></br>
            </ul>
            <button id="button" type="button" class="btn btn-primary active">Resources</button>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <button id="button5" type="button" class="btn btn-success active">Load</button>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <button id="button10" class="btn btn-danger active" type="button">Delete Checked</button>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <b>Apikey:</b><input id="apikey" class="form-control" size="5" type="text" placeholder="apikey" value="sos"/></br></br>
      </form>
    </div>
      <div class="dropdown">
        <form class="form-inline">
          <button class="btn btn-success active" type="button" id="menu1" data-toggle="dropdown">Resource<span class="caret"></span></button>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <ul class="dropdown-menu" id="pedro" role="menu" aria-labelledby="menu1">
              <li role="presentation"><b>Write each of the fields:</b>
              <li role="presentation"><input id="nombre2" class="form-control" size="15" type="text" placeholder="name"></li>
              <li role="presentation"><input id="mes" class="form-control" size="15" type="text" placeholder="month"></li>
              <li role="presentation"><input id="year" class="form-control" size="15" type="number" placeholder="year"></li>
              <li role="presentation"><input id="pression" class="form-control" size="15" type="number" placeholder="pression"></li>
              <li role="presentation"><input id="temperature" class="form-control" size="15" type="number" placeholder="temperature"></li>
              <li role="presentation"><input id="td" class="form-control" size="15" type="number" placeholder="t.d."></br></br></li>
              <li role="presentation">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<button id="button3" class="btn btn-warning active" type="button">Edit</button>&nbsp;&nbsp;&nbsp;&nbsp;<button id="button2" class="btn btn-success active" type="button" >Add</button></li>
            </ul>
            <button id="button11" type="button" class="btn btn-primary active">FROM/TO</button>
            <div class="form-group">
              <input id="nombre3" class="form-control" size="10" type="text" placeholder="Name" >
              <input id="from" class="form-control" type="number"size="15" placeholder="From">
              <input id="to" class="form-control" type="number"size="15" placeholder="To">
            </div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        </form>
      </div></br><br>
      <span id="log1"></span>
      <br/><br/>
    </div>
</body>
</html>
